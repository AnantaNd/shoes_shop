import Head from 'next/head'
import Image from 'next/image'
import Link from 'next/link'
import { useEffect, useState } from 'react'
import { A11y, Navigation, Pagination, Scrollbar } from 'swiper'
import { Swiper, SwiperSlide } from 'swiper/react'
import Card from '../components/Card/Card'
import Layouts from '../components/Layouts/Layouts'
import Section from '../components/Section/Section'
import style from '../styles/Home.module.css'

import 'swiper/css'
import 'swiper/css/navigation'
import 'swiper/css/pagination'
import 'swiper/css/scrollbar'

export default function Home() {
  const [data, setData] = useState([])

  const fetchApiAsyncAwait = async () => {
    try {
      const response = await fetch('/api/products');
      const data = await response.json();
      setData(data)
      console.log(data)
    } catch (err) {
      console.error('Error' + err);
    }
  };

  useEffect(() => {
    fetchApiAsyncAwait();
  }, [])

  return (
    <div className={style.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <Layouts>
        <Section>
          <div className={style.hero}>
            <div className={style.hero__container}>
              <h1 className={style.hero__headline}>Lets Make <br /> Your Day <span className={style.highlight}>Excited</span></h1>
              <p className={style.hero__headlinesupport}>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit ut aliquam, purus sit amet luctus venenatis, lectus magna fringilla urna, porttitor rhoncus dolor purus non enim praesent elementum facilisis leo, vel fringilla est ullamcorper eget nulla facilisi etiam dignissim diam quis.
              </p>
              <Link href="/products"><button className={style.cta}> Get Started</button></Link>
            </div>
            <div className={style.banner}>
              <Image src="/hero_banner.png" width="500" height="470" style={{ marginLeft: 8 + "px" }} />
            </div>

          </div>
        </Section>
        <Section>
          <div className={style.section__container}>
            <h1 className={style.section__title}>BRANDS</h1>
            <div className={style.brands}>
              <Image src="/brand_nike.png" width="128" height="80" />
              <Image src="/brand_adidas.png" width="128" height="80" />
              <Image src="/brand_reebok.png" width="128" height="80" />
            </div>
          </div>
        </Section>
        <Section>
          <div className={style.section__container}>
            <h1 className={style.section__title}>PRODUCTS</h1>
            <Swiper
              modules={[Navigation, Pagination, Scrollbar, A11y]}
              navigation={{
                nextEl: 'Next',
                prevEl: 'Prev',
              }}

              style={
                {
                  paddingTop: 20 + 'px',
                  paddingBottom: 20 + 'px',
                  marginTop: 24 + 'px'
                }
              }
              breakpoints={{
                0: {
                  slidesPerView: 1,
                  spaceBetween: 100
                },
                1024: {
                  slidesPerView: 3,
                  spaceBetween: 10
                },
                1440: {
                  slidesPerView: 5,
                  spaceBetween: 50
                },
                1728:{
                  slidesPerView: 5,
                  spaceBetween: 5
                }
              }}
            >
              {data.length != 0 && data.map((shoes, i) =>
                <SwiperSlide key={i}>
                  <Card
                    className={style.item}
                    img={'/sepatu.png'}
                    name={shoes.name}
                    price={shoes.price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.')}
                    ratting={shoes.rating}
                  />
                </SwiperSlide>
              )}
            </Swiper>
          </div>
        </Section>
      </Layouts>
    </div>
  )
}
